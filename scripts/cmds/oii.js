module.exports = {
  config: {
    name: "oii",
    version: "2.0.0",
    author: "Alihsan Shourov",
    role: 2,
    shortDescription: "Romantic message spam",
    longDescription: "Send romantic messages to mention/reply/uid",
    category: "fun",
    guide: "{pn} @mention / reply / uid"
  },

  onStart: async function ({ api, event, usersData, args, resolveTargetID }) {
    try {
      const { threadID, messageID } = event;

      // ===== TARGET DETECT =====
      let targetID = resolveTargetID(args);

      // UID manual support
      if (!targetID && args[0] && !isNaN(args[0])) {
        targetID = args[0];
      }

      if (!targetID) {
        return api.sendMessage(
          "тЪая╕П ржПржХржЬржиржХрзЗ mention ржХрж░рзБржи, reply ржжрж┐ржи, ржЕржержмрж╛ UID ржжрж┐ржиред",
          threadID,
          messageID
        );
      }

      const name = await usersData.getName(targetID);

      const mentionTag = [{
        id: targetID,
        tag: name
      }];

      const messages = [
        "рж╕рзНржмрж░рзНржЧ ржЖржорж┐ ржЪрж╛ржЗ ржирж╛ ржХрж╛рж░ржг ржЖржорж┐ рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗржЫрж┐,\nрж╕рзНржмржкрзНржи ржЖржорж┐ ржжрзЗржЦрждрзЗ ржЪрж╛ржЗ ржирж╛ ржХрж╛рж░ржг рждрзБржорж┐ржЗ ржЖржорж╛рж░ рж╕рзНржмржкрзНржи ЁЯТЦ",
        "ржЬрж╛ржи рждрзБржорж┐ ржПржд рж╕рзБржирзНржжрж░ ржХрзЗржи, рждрзЛржорж╛ржпрж╝ ржирж╛ ржжрзЗржЦрзЗ ржерж╛ржХрждрзЗ ржкрж╛рж░рж┐ ржирж╛ ЁЯШШ",
        "рждрзБржорж┐ ржпржжрж┐ ржЖржорж╛рж░ ржирж╛ рж╣ржУ, ржПржЗ ржЬрзАржмржиржЯрж╛ржЗ ржЕрж░рзНржерж╣рзАржи ЁЯе║",
        "рждрзБржорж┐ ржЖржорж╛рж░ ржЪрзЛржЦрзЗрж░ рж╕рзЗржЗ ржкрж░рзА, ржпрж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржХрж┐ржЫрзБржЗ ржнрж╛рж▓рзЛ рж▓рж╛ржЧрзЗ ржирж╛ тЬи",
        "рждрзЛржорж╛рж░ ржЪрж┐ржирзНрждрж╛ ржЖржорж╛рж░ ржоржи ржерзЗржХрзЗ ржХржЦржирзЛ ржпрж╛ржмрзЗ ржирж╛ ржЬрж╛ржи ЁЯТн",
        "ржЯржорзЗржЯрзЛ рж▓рж╛рж▓ ЁЯМ╢я╕П рждрзЛржорж╛рж░ ржмрзБржХрзЗрж░ ржорж╛ржЭрзЗ ржЪрзБржорзБ ржжрзЗржмрзЛ ржЖржорж┐ ржЪрж┐рж░ржХрж╛рж▓ ЁЯТЛ",
        "ржЬрж╛ржи рждрзЛржорж╛рж░ ржПржХржЯрзБржЦрж╛ржирж┐ ржЖржжрж░рзЗржЗ ржЖржорж┐ ржкрж╛ржЧрж▓ ЁЯШН",
        "рждрзЛржорж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржЦрж╛ржУрзЯрж╛-ржШрзБржо рж╕ржм ржмржирзНржз ржЬрж╛ржи ЁЯШФ",
        "I Love You ржЬрж╛ржи тЭдя╕П рждрзЛржорж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржмрж╛ржБржЪржмрзЛ ржирж╛",
        "ржнрж╛рж▓ржмрж╛рж╕рж┐ рж╢рзБржзрзБ рждрзЛржорж╛ржХрзЗржЗ ржнрж╛рж▓ржмрж╛рж╕рж┐ ЁЯТХ",
        "рждрзБржорж┐ ржЫрж╛рзЬрж╛ ржЖржорж╛рж░ ржоржи ржХрж┐ржЫрзБржЗ ржмрзЛржЭрзЗ ржирж╛ ЁЯЦд",
        "ржПржХржжрж┐ржи ржХржерж╛ ржирж╛ рж╣рж▓рзЗ ржоржиржЯрж╛ ржорж░рзЗ ржпрж╛рзЯ ЁЯШв",
        "рждрзЛржорж╛ржХрзЗ ржжрзЗржЦрж▓рзЗржЗ ржоржиржЯрж╛ ржнрж╛рж▓рзЛ рж╣рзЯрзЗ ржпрж╛рзЯ ЁЯе░",
        "рждрзБржорж┐ ржЖржорж╛рж░ рж╕ржмржХрж┐ржЫрзБ ржЬрж╛ржи ЁЯМ╣",
        "рждрзЛржорж╛рж░ рж╕рж╛ржерзЗржЗ ржЖржорж╛рж░ рж╢рж╛ржирзНрждрж┐ ЁЯдН"
      ];

      // ===== HEADER =====
      await api.sendMessage(
        {
          body: "ЁЯдЦ ЁЭРТЁЭРЗЁЭРОЁЭРФЁЭРСЁЭРОЁЭРХ ЁЭРБЁЭРОЁЭРУ ЁЭРИЁЭРНЁЭРВЁЭРОЁЭРМЁЭРИЁЭРНЁЭРЖ ЁЯТМ",
        },
        threadID
      );

      // ===== SEND WITH DELAY =====
      for (let i = 0; i < messages.length; i++) {
        setTimeout(() => {
          api.sendMessage(
            {
              body: `${messages[i]}\n\nтАФ @${name}`,
              mentions: mentionTag
            },
            threadID
          );
        }, (i + 1) * 1200);
      }

      // ===== FINISH MESSAGE =====
      setTimeout(() => {
        api.sendMessage(
          {
            body: "ЁЯТЦ Message sequence completed.",
          },
          threadID
        );
      }, (messages.length + 2) * 1200);

    } catch (err) {
      console.error("oii command error:", err);
      api.sendMessage(
        "тЭМ ржХржорж╛ржирзНржб ржЪрж╛рж▓рж╛рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣рзЯрзЗржЫрзЗ, ржкрж░рзЗ ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред",
        event.threadID
      );
    }
  }
};